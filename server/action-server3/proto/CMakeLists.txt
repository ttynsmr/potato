INCLUDE(FindProtobuf)
FIND_PACKAGE(Protobuf REQUIRED)
INCLUDE_DIRECTORIES(${PROTOBUF_INCLUDE_DIR})

FILE(GLOB PROTO_SOURCES RELATIVE "${CMAKE_SOURCE_DIR}/proto/" CONFIGURE_DEPENDS "*.proto")
MESSAGE("PROTO_SOURCES: ${PROTO_SOURCES}")

PROTOBUF_GENERATE_CPP(PROTO_SRC PROTO_HEADER ${PROTO_SOURCES})
ADD_LIBRARY(proto ${PROTO_HEADER} ${PROTO_SRC})

add_dependencies(proto rpc)
